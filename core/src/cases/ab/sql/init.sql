SET LOCAL sql_mode=(SELECT REPLACE(@@sql_mode,'ONLY_FULL_GROUP_BY',''));
CREATE TABLE IF NOT EXISTS `groups` (id TINYINT UNSIGNED NOT NULL AUTO_INCREMENT, name VARCHAR(127) CHARACTER SET utf8 NOT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY(`id`));
CREATE TABLE IF NOT EXISTS `users` (id INT UNSIGNED NOT NULL AUTO_INCREMENT, group_id TINYINT UNSIGNED NOT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY(`id`), CONSTRAINT `fk_user_group_id` FOREIGN KEY (group_id) REFERENCES `groups` (id) ON DELETE CASCADE ON UPDATE RESTRICT);
CREATE TABLE IF NOT EXISTS `visit_events` (id INT UNSIGNED NOT NULL AUTO_INCREMENT, group_id TINYINT UNSIGNED NOT NULL, user_id INT UNSIGNED NOT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY(`id`), CONSTRAINT `fk_visit_event_group_id` FOREIGN KEY (group_id) REFERENCES `groups` (id) ON DELETE CASCADE ON UPDATE RESTRICT, CONSTRAINT `fk_visit_event_user_id` FOREIGN KEY (user_id) REFERENCES `users` (id) ON DELETE CASCADE ON UPDATE RESTRICT );
CREATE TABLE IF NOT EXISTS `click_events` (id INT UNSIGNED NOT NULL AUTO_INCREMENT, group_id TINYINT UNSIGNED NOT NULL, user_id INT UNSIGNED NOT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY(`id`), CONSTRAINT `fk_click_event_group_id` FOREIGN KEY (group_id) REFERENCES `groups` (id) ON DELETE CASCADE ON UPDATE RESTRICT, CONSTRAINT `fk_click_event_user_id` FOREIGN KEY (user_id) REFERENCES `users` (id) ON DELETE CASCADE ON UPDATE RESTRICT );
